# Example configuration for sab (swing alert bot)

version: 1

data:
  provider: kis
  screen_limit: 30
  report_dir: reports
  data_dir: data

kis:
  app_key: your_app_key
  app_secret: your_app_secret
  base_url: https://openapivts.koreainvestment.com
  min_interval_ms: 500

screener:
  enabled: true
  limit: 20
  only: false
  cache_ttl_minutes: 5
  min_price: 1000
  min_dollar_volume: 5000000000
  us:
    min_price: 5         # USD 기준 최소 가격
    min_dollar_volume: 5_000_000  # USD 기준(예: 500만 달러)
  # US simple screener defaults (optional)
  us_defaults:
    - AAPL.US
    - MSFT.US
    - NVDA.US
    - AMZN.US
    - META.US
    - GOOGL.US
  # US screener mode: 'defaults' or 'kis' (KIS rank APIs)
  us_mode: defaults
  # US KIS rank metric: 'volume' | 'market_cap' | 'value'
  us_metric: volume
  us_limit: 20

strategy:
  # Buy strategy mode: 'ema_cross' (current EMA20/50) or 'sma_ema_hybrid' (SMA20 + EMA10/21 hybrid, planned)
  mode: ema_cross
  use_sma200_filter: true
  require_slope_up: true
  gap_atr_multiplier: 1.0
  min_history_bars: 200
  exclude_etf_etn: true
  rs_lookback_days: 60
  rs_benchmark_return: 0.0
  # Hybrid strategy tuning (used when mode = sma_ema_hybrid)
  hybrid:
    sma_trend_period: 20          # SMA20: mid-term trend
    ema_short_period: 10          # EMA10: pullback/entry
    ema_mid_period: 21            # EMA21: medium-term momentum/support
    rsi_period: 14                # RSI(14)
    rsi_zone_low: 45.0            # swing zone lower bound
    rsi_zone_high: 60.0           # swing zone upper bound
    rsi_oversold_low: 30.0        # oversold band low
    rsi_oversold_high: 40.0       # oversold band high
    pullback_max_bars: 10         # max bars in pullback phase
    breakout_consolidation_min_bars: 5   # min bars in pre-breakout base
    breakout_consolidation_max_bars: 15  # max bars in pre-breakout base
    volume_lookback_days: 5       # volume lookback for 5-day avg
    max_gap_pct: 0.05             # hard cap on acceptable gap (5%)
    use_sma60_filter: false       # optional SMA60 filter for KR mid/small caps
    sma60_period: 60
    kr_breakout_requires_confirmation: true  # require confirmation candle for KR breakouts

sell:
  # Sell mode: 'generic' (ATR/EMA20/50-based) or 'sma_ema_hybrid' (profit band + SMA20/EMA10/21 rules)
  mode: generic
  atr_trail_multiplier: 1.0
  time_stop_days: 10
  require_sma200: true
  ema_short: 20
  ema_long: 50
  rsi_period: 14
  rsi_floor: 50
  rsi_floor_alt: 30
  min_bars: 20
  # Hybrid sell tuning (used when mode = sma_ema_hybrid)
  hybrid:
    profit_target_low: 0.05        # 1st profit threshold (5%)
    profit_target_high: 0.10       # high profit threshold (10%)
    partial_profit_floor: 0.03     # partial-profit zone floor (3%)
    ema_short_period: 10           # EMA short for trend breakdown
    ema_mid_period: 21             # EMA mid for trend breakdown
    sma_trend_period: 20           # SMA20 trend baseline
    rsi_period: 14                 # RSI period for sell checks
    stop_loss_pct_min: 0.03        # lower bound of hard stop band (3%)
    stop_loss_pct_max: 0.05        # upper bound of hard stop band (5%)
    failed_breakout_drop_pct: 0.03 # breakout failure threshold (3% below entry)
    min_bars: 20                   # minimum bars required for evaluation
    time_stop_days: 0              # optional time stop (0 disables)
    time_stop_grace_days: 0        # extra days after time_stop_days before hard exit (0 disables)
    time_stop_profit_floor: 0.00   # P&L floor to avoid hard exit after grace (e.g., 0.03 = 3%)

entry_check:
  enabled: false

universe:
  markets:
    - KR
    - US

files:
  holdings: holdings.yaml
  watchlist: watchlist.txt

fx:
  mode: kis              # kis | manual | off
  cache_ttl_minutes: 10  # FX 캐시 유지 시간(분)
  kis_symbol: AAPL.NAS   # 선택: 환율 조회용 대표 종목 (없으면 자동 추정)
  usdkrw: 1320.0         # manual 모드 또는 폴백용 고정 환율
